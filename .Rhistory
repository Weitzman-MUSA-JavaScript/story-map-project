tm_map(., removeWords, stopwords("english"))
dtm <- TermDocumentMatrix(docs)
matrix <- as.matrix(dtm)
words <- sort(rowSums(matrix),decreasing=TRUE)
df <- data.frame(word = names(words),freq=words) %>%
filter(word != "american")
set.seed(1234) # for reproducibility
wordcloud2(data = df, size = 0.8, color = "random-light")
View(unclassified)
# Location of all restaurants
ggplot() +
geom_sf(data = restaurants, color = "darkcyan", size = 0.5) +
labs(
title = "Location of Restaurants in Philadelphia",
) +
theme_void()
# Plot the distribution of cuisine types, ordered by count
ggplot() +
geom_bar(data = restaurants, aes(x = cuisine), show.legend = FALSE, fill = "darkcyan") +
coord_flip() +
scale_x_discrete(limits = restaurants %>% filter(cuisine != "American") %>% count(cuisine) %>% arrange(n) %>% pull(cuisine)) +
labs(
title = "Distribution of Cuisine Types",
x = "Cuisine",
y = "Restaurants"
) +
theme_minimal()
# Plot the distribution of cuisine types, ordered by count
ggplot() +
geom_bar(data = restaurants %>% filter(cuisine != "Unknown"), aes(x = cuisine), show.legend = FALSE, fill = "darkcyan") +
coord_flip() +
scale_x_discrete(limits = restaurants %>% filter(cuisine != "American") %>% count(cuisine) %>% arrange(n) %>% pull(cuisine)) +
labs(
title = "Distribution of Cuisine Types",
x = "Cuisine",
y = "Restaurants"
) +
theme_minimal()
# Plot the distribution of cuisine types, ordered by count
ggplot() +
geom_bar(data = restaurants %>% filter(cuisine %in% c("Unknown", "American")), aes(x = cuisine), show.legend = FALSE, fill = "darkcyan") +
coord_flip() +
scale_x_discrete(limits = restaurants %>% filter(cuisine %in% c("Unknown", "American")) %>% count(cuisine) %>% arrange(n) %>% pull(cuisine)) +
labs(
title = "Distribution of Cuisine Types",
x = "Cuisine",
y = "Restaurants"
) +
theme_minimal()
# Plot the distribution of cuisine types, ordered by count
ggplot() +
geom_bar(data = restaurants %>% filter(!cuisine %in% c("Unknown", "American")), aes(x = cuisine), show.legend = FALSE, fill = "darkcyan") +
coord_flip() +
scale_x_discrete(limits = restaurants %>% filter(!cuisine %in% c("Unknown", "American")) %>% count(cuisine) %>% arrange(n) %>% pull(cuisine)) +
labs(
title = "Distribution of Cuisine Types",
x = "Cuisine",
y = "Restaurants"
) +
theme_minimal()
# Plot the distribution of cuisine types, ordered by count
exclude <- c("Unknown", "American", "Seafood")
ggplot() +
geom_bar(data = restaurants %>% filter(!cuisine %in% exclude), aes(x = cuisine), show.legend = FALSE, fill = "darkcyan") +
coord_flip() +
scale_x_discrete(limits = restaurants %>% filter(!cuisine %in% exclude) %>% count(cuisine) %>% arrange(n) %>% pull(cuisine)) +
labs(
title = "Distribution of Cuisine Types",
x = "Cuisine",
y = "Restaurants"
) +
theme_minimal()
cuisine_neigh <- st_intersection(restaurants, neighs) %>%
st_drop_geometry() %>%
left_join(neighs, by = "MAPNAME") %>%
group_by(cuisine, MAPNAME) %>%
summarise(count = n(), .groups = 'drop') %>%
group_by(MAPNAME) %>%
mutate(pct = 100 * count / sum(count)) %>%
ungroup() %>%
left_join(neighs, by = "MAPNAME") %>%
st_as_sf()
cuisine_neigh <- st_intersection(restaurants, neighs) %>%
st_drop_geometry() %>%
left_join(neighs, by = "MAPNAME") %>%
group_by(cuisine, MAPNAME) %>%
summarise(count = n(), .groups = 'drop') %>%
group_by(MAPNAME) %>%
mutate(pct = 100 * count / sum(count)) %>%
ungroup() %>%
left_join(neighs, by = "MAPNAME") %>%
st_as_sf()
top_ethnic_cuisine_neigh <- cuisine_neigh %>%
filter(! cuisine %in% exclude) %>%
group_by(MAPNAME) %>%
slice_max(order_by = pct)
# Map most common cuisine in each neighborhood
ggplot() +
geom_sf(data = top_ethnic_cuisine_neigh, aes(fill = cuisine), color = "white") +
scale_fill_brewer(palette = "Set3") +
labs(
title = "Most Common Cuisine in Each Neighborhood",
fill = "Cuisine"
) +
theme_void()
cuisine_neigh <- st_intersection(restaurants, neighs) %>%
st_drop_geometry() %>%
left_join(neighs, by = "MAPNAME") %>%
group_by(cuisine, MAPNAME) %>%
summarise(count = n(), .groups = 'drop') %>%
group_by(MAPNAME) %>%
mutate(pct = 100 * count / sum(count)) %>%
ungroup() %>%
left_join(neighs, by = "MAPNAME") %>%
st_as_sf()
# Map most common cuisine in each neighborhood
ggplot() +
geom_sf(data = top_ethnic_cuisine_neigh, aes(fill = cuisine), color = "white") +
#scale_fill_brewer(palette = "Set3") +
labs(
title = "Most Common Cuisine in Each Neighborhood",
fill = "Cuisine"
) +
theme_void()
# Map most common cuisine in each neighborhood
ggplot() +
geom_sf(data = top_ethnic_cuisine_neigh, aes(fill = cuisine), color = "white") +
scale_fill_brewer(palette = "Set2") +
labs(
title = "Most Common Cuisine in Each Neighborhood",
fill = "Cuisine"
) +
theme_void()
# Map most common cuisine in each neighborhood
ggplot() +
geom_sf(data = top_ethnic_cuisine_neigh, aes(fill = cuisine), color = "white") +
scale_fill_brewer(palette = "Set2") +
labs(
title = "Most Common Cuisine in Each Neighborhood",
fill = "Cuisine"
) +
theme_void()
ggplot() +
geom_sf(data = top_ethnic_cuisine_neigh, aes(fill = cuisine), color = "white") +
scale_fill_brewer(palette = "Dark2") +
labs(
title = "Most Common Cuisine in Each Neighborhood",
fill = "Cuisine"
) +
theme_void()
# Map most common cuisine in each neighborhood
ggplot() +
geom_sf(data = top_ethnic_cuisine_neigh, aes(fill = cuisine), color = "white") +
scale_fill_brewer(palette = "Dark3") +
labs(
title = "Most Common Cuisine in Each Neighborhood",
fill = "Cuisine"
) +
theme_void()
# Map most common cuisine in each neighborhood
ggplot() +
geom_sf(data = top_ethnic_cuisine_neigh, aes(fill = cuisine), color = "white") +
scale_fill_brewer(palette = "Dark") +
labs(
title = "Most Common Cuisine in Each Neighborhood",
fill = "Cuisine"
) +
theme_void()
# Map most common cuisine in each neighborhood
ggplot() +
geom_sf(data = top_ethnic_cuisine_neigh, aes(fill = cuisine), color = "white") +
scale_fill_brewer(palette = "Set3") +
labs(
title = "Most Common Cuisine in Each Neighborhood",
fill = "Cuisine"
) +
theme_void()
tracts <- tracts("PA", "Philadelphia") %>%
st_transform(4326)
View(tracts)
tracts <- tracts("PA", "Philadelphia") %>%
st_transform(4326) %>%
select(NAME)
cuisine_tract <- st_intersection(restaurants, tracts) %>%
st_drop_geometry() %>%
left_join(tracts, by = "NAME") %>%
group_by(cuisine, NAME) %>%
summarise(count = n(), .groups = 'drop') %>%
group_by(NAME) %>%
mutate(pct = 100 * count / sum(count)) %>%
ungroup() %>%
left_join(tracts, by = "NAME") %>%
st_as_sf()
top_ethnic_cuisine_tract <- cuisine_tract %>%
filter(! cuisine %in% exclude) %>%
group_by(NAME) %>%
slice_max(order_by = pct)
# Map most common cuisine in each census tract
ggplot() +
geom_sf(data = top_ethnic_cuisine_tract, aes(fill = cuisine), color = "white") +
scale_fill_brewer(palette = "Set3") +
labs(
title = "Most Common Cuisine in Each Census Tract",
fill = "Cuisine"
) +
theme_void()
View(top_ethnic_cuisine_neigh)
# Map most common cuisine in each census tract
ggplot() +
geom_sf(data = top_ethnic_cuisine_tract %>% filter(pct > 50), aes(fill = cuisine), color = "white") +
scale_fill_brewer(palette = "Set3") +
labs(
title = "Most Common Cuisine in Each Census Tract",
fill = "Cuisine"
) +
theme_void()
# Map most common cuisine in each census tract
ggplot() +
geom_sf(data = top_ethnic_cuisine_tract %>% filter(pct > 30), aes(fill = cuisine), color = "white") +
scale_fill_brewer(palette = "Set3") +
labs(
title = "Most Common Cuisine in Each Census Tract",
fill = "Cuisine"
) +
theme_void()
# Map most common cuisine in each census tract
ggplot() +
geom_sf(data = top_ethnic_cuisine_tract %>% filter(pct > 30), aes(fill = cuisine), color = "white") +
scale_fill_brewer(palette = "Set3") +
labs(
title = "Census tracts with more than 30% of an ethnic cuisine",
fill = "Cuisine"
) +
theme_void()
# Map most common cuisine in each census tract
ggplot() +
geom_sf(data = st_union(neighs), fill = "gray", color = "transparent") +
geom_sf(data = top_ethnic_cuisine_tract %>% filter(pct > 30), aes(fill = cuisine), color = "white") +
scale_fill_brewer(palette = "Set3") +
labs(
title = "Census tracts with more than 30% of an ethnic cuisine",
fill = "Cuisine"
) +
theme_void()
# Map most common cuisine in each census tract
ggplot() +
geom_sf(data = st_union(neighs), fill = "gray90", color = "transparent") +
geom_sf(data = top_ethnic_cuisine_tract %>% filter(pct > 30), aes(fill = cuisine), color = "white") +
scale_fill_brewer(palette = "Set3") +
labs(
title = "Census tracts with more than 30% of an ethnic cuisine",
fill = "Cuisine"
) +
theme_void()
View(top_ethnic_cuisine_tract)
# Map most common cuisine in each census tract
ggplot() +
geom_sf(data = st_union(neighs), fill = "gray90", color = "transparent") +
geom_sf(data = top_ethnic_cuisine_tract %>% filter(pct > 20), aes(fill = cuisine), color = "white") +
scale_fill_brewer(palette = "Set3") +
labs(
title = "Census tracts with more than 30% of an ethnic cuisine",
fill = "Cuisine"
) +
theme_void()
# Map most common cuisine in each census tract
ggplot() +
geom_sf(data = st_union(neighs), fill = "gray90", color = "transparent") +
geom_sf(data = top_ethnic_cuisine_tract %>% filter(count > 5), aes(fill = cuisine), color = "white") +
scale_fill_brewer(palette = "Set3") +
labs(
title = "Census tracts with more than 30% of an ethnic cuisine",
fill = "Cuisine"
) +
theme_void()
# Map most common cuisine in each census tract
ggplot() +
geom_sf(data = st_union(neighs), fill = "gray90", color = "transparent") +
geom_sf(data = top_ethnic_cuisine_tract %>% filter(count > 4), aes(fill = cuisine), color = "white") +
scale_fill_brewer(palette = "Set3") +
labs(
title = "Census tracts with more than 30% of an ethnic cuisine",
fill = "Cuisine"
) +
theme_void()
# Map most common cuisine in each census tract
ggplot() +
geom_sf(data = st_union(neighs), fill = "gray90", color = "transparent") +
geom_sf(data = top_ethnic_cuisine_tract %>% filter(count > 2 & pct > 10), aes(fill = cuisine), color = "white") +
scale_fill_brewer(palette = "Set3") +
labs(
title = "Census tracts with more than 30% of an ethnic cuisine",
fill = "Cuisine"
) +
theme_void()
# Map most common cuisine in each census tract
ggplot() +
geom_sf(data = st_union(neighs), fill = "gray90", color = "transparent") +
geom_sf(data = top_ethnic_cuisine_tract %>% filter(pct > 10), aes(fill = cuisine), color = "white") +
scale_fill_brewer(palette = "Set3") +
labs(
title = "Census tracts with more than 30% of an ethnic cuisine",
fill = "Cuisine"
) +
theme_void()
# Map most common cuisine in each census tract
ggplot() +
geom_sf(data = st_union(neighs), fill = "gray90", color = "transparent") +
geom_sf(data = top_ethnic_cuisine_tract %>% filter(count > 2 & pct > 10), aes(fill = cuisine), color = "white") +
scale_fill_brewer(palette = "Set3") +
labs(
title = "Census tracts with more than 30% of an ethnic cuisine",
fill = "Cuisine"
) +
theme_void()
# Map most common cuisine in each census tract
ggplot() +
geom_sf(data = st_union(neighs), fill = "gray95", color = "transparent") +
geom_sf(data = top_ethnic_cuisine_tract %>% filter(count > 2 & pct > 10), aes(fill = cuisine), color = "white") +
scale_fill_brewer(palette = "Set3") +
labs(
title = "Census tracts with more than 30% of an ethnic cuisine",
fill = "Cuisine"
) +
theme_void()
# Map most common cuisine in each census tract
ggplot() +
geom_sf(data = st_union(neighs), fill = "gray95", color = "transparent") +
geom_sf(data = top_ethnic_cuisine_tract %>% filter(count > 2 & pct > 10), aes(fill = cuisine), color = "white") +
scale_fill_brewer(palette = "Set2") +
labs(
title = "Census tracts with more than 30% of an ethnic cuisine",
fill = "Cuisine"
) +
theme_void()
# Map most common cuisine in each census tract
ggplot() +
geom_sf(data = st_union(neighs), fill = "gray95", color = "transparent") +
geom_sf(data = top_ethnic_cuisine_tract %>% filter(count > 2 & pct > 10), aes(fill = cuisine), color = "white") +
scale_fill_brewer(palette = "Dark2") +
labs(
title = "Census tracts with more than 30% of an ethnic cuisine",
fill = "Cuisine"
) +
theme_void()
# Map most common cuisine in each census tract
ggplot() +
geom_sf(data = st_union(neighs), fill = "gray95", color = "transparent") +
geom_sf(data = top_ethnic_cuisine_tract %>% filter(count > 2 & pct > 10), aes(fill = cuisine), color = "white") +
scale_fill_brewer(palette = "Dark3") +
labs(
title = "Census tracts with more than 30% of an ethnic cuisine",
fill = "Cuisine"
) +
theme_void()
# Map most common cuisine in each census tract
ggplot() +
geom_sf(data = st_union(neighs), fill = "gray95", color = "transparent") +
geom_sf(data = top_ethnic_cuisine_tract %>% filter(count > 2 & pct > 10), aes(fill = cuisine), color = "white") +
scale_fill_brewer(palette = "Set3", direction = 1) +
labs(
title = "Census tracts with more than 30% of an ethnic cuisine",
fill = "Cuisine"
) +
theme_void()
# Map most common cuisine in each census tract
ggplot() +
geom_sf(data = st_union(neighs), fill = "gray95", color = "transparent") +
geom_sf(data = top_ethnic_cuisine_tract %>% filter(count > 2 & pct > 10), aes(fill = cuisine), color = "white") +
scale_fill_brewer(palette = "Set3", direction = -1) +
labs(
title = "Census tracts with more than 30% of an ethnic cuisine",
fill = "Cuisine"
) +
theme_void()
spruce_hill_restaurants <- neighs %>%
filter(MAPNAME %in% c("Spruce Hill", "Walnut Hill")) %>%
st_intersection(restaurants)
spruce_hill_restaurants <- neighs %>%
filter(MAPNAME %in% c("Spruce Hill")) %>%
st_intersection(restaurants)
mapview(spruce_hill_restaurants)
# Plot and color by cuisine
ggplot() +
geom_sf(data = spruce_hill_restaurants, aes(fill = cuisine), color = "white") +
scale_fill_brewer(palette = "Set3") +
labs(
title = "Restaurants in Spruce Hill",
fill = "Cuisine"
) +
theme_void()
# Plot and color by cuisine
ggplot() +
geom_sf(data = spruce_hill_restaurants, aes(color = cuisine)) +
scale_fill_brewer(palette = "Set3") +
labs(
title = "Restaurants in Spruce Hill",
fill = "Cuisine"
) +
theme_void()
# Plot and color by cuisine
ggplot() +
geom_sf(data = spruce_hill_restaurants, aes(color = cuisine)) +
scale_color_brewer(palette = "Set3") +
labs(
title = "Restaurants in Spruce Hill",
fill = "Cuisine"
) +
theme_void()
# Map most common cuisine in each neighborhood
ggplot() +
geom_sf(data = st_union(neighs), fill = "gray95", color = "transparent") +
geom_sf(data = top_ethnic_cuisine_neigh %>% filter(count > 5 & pct > 10), aes(fill = cuisine), color = "white") +
scale_fill_brewer(palette = "Set3") +
labs(
title = "Most Common Cuisine in Each Neighborhood",
fill = "Cuisine"
) +
theme_void()
# Map most common cuisine in each census tract
ggplot() +
geom_sf(data = st_union(neighs), fill = "gray95", color = "transparent") +
geom_sf(data = top_ethnic_cuisine_tract %>% filter(count > 5), aes(fill = cuisine), color = "white") +
scale_fill_brewer(palette = "Set3", direction = -1) +
labs(
title = "Census tracts with more than 30% of an ethnic cuisine",
fill = "Cuisine"
) +
theme_void()
# Map most common cuisine in each neighborhood
ggplot() +
geom_sf(data = st_union(neighs), fill = "gray95", color = "transparent") +
geom_sf(data = top_ethnic_cuisine_neigh %>% filter(count > 5), aes(fill = cuisine), color = "white") +
scale_fill_brewer(palette = "Set3") +
labs(
title = "Most Common Cuisine in Each Neighborhood",
fill = "Cuisine"
) +
theme_void()
# Map most common cuisine in each census tract
ggplot() +
geom_sf(data = st_union(neighs), fill = "gray95", color = "transparent") +
geom_sf(data = top_ethnic_cuisine_tract %>% filter(count > 5), aes(fill = cuisine), color = "white") +
scale_fill_brewer(palette = "Set3", direction = -1) +
labs(
title = "Census tracts with more than 30% of an ethnic cuisine",
fill = "Cuisine"
) +
theme_void()
# Map most common cuisine in each census tract
ggplot() +
geom_sf(data = st_union(neighs), fill = "gray95", color = "transparent") +
geom_sf(data = top_ethnic_cuisine_tract %>% filter(count > 5), aes(fill = cuisine), color = "white") +
scale_fill_brewer(palette = "Set3", direction = -1) +
labs(
title = "Census tracts with more than 30% of an ethnic cuisine",
fill = "Cuisine"
) +
theme_void()
# Map most common cuisine in each neighborhood
ggplot() +
geom_sf(data = st_union(neighs), fill = "gray95", color = "transparent") +
geom_sf(data = top_ethnic_cuisine_neigh %>% filter(count > 10), aes(fill = cuisine), color = "white") +
scale_fill_brewer(palette = "Set3") +
labs(
title = "Most Common Cuisine in Each Neighborhood",
fill = "Cuisine"
) +
theme_void()
# Map most common cuisine in each census tract
ggplot() +
geom_sf(data = st_union(neighs), fill = "gray95", color = "transparent") +
geom_sf(data = top_ethnic_cuisine_tract %>% filter(count > 5), aes(fill = cuisine), color = "white") +
scale_fill_brewer(palette = "Set3", direction = -1) +
labs(
title = "Census tracts with more than 30% of an ethnic cuisine",
fill = "Cuisine"
) +
theme_void()
# Map most common cuisine in each census tract
ggplot() +
geom_sf(data = st_union(neighs), fill = "gray95", color = "transparent") +
geom_sf(data = top_ethnic_cuisine_tract %>% filter(count > 3), aes(fill = cuisine), color = "white") +
scale_fill_brewer(palette = "Set3", direction = -1) +
labs(
title = "Census tracts with more than 30% of an ethnic cuisine",
fill = "Cuisine"
) +
theme_void()
# Map most common cuisine in each census tract
ggplot() +
geom_sf(data = st_union(neighs), fill = "gray95", color = "transparent") +
geom_sf(data = top_ethnic_cuisine_tract %>% filter(count > 3), aes(fill = cuisine), color = "white") +
scale_fill_brewer(palette = "Set3", direction = 1) +
labs(
title = "Census tracts with more than 30% of an ethnic cuisine",
fill = "Cuisine"
) +
theme_void()
knitr::opts_chunk$set(
echo = TRUE,
message = FALSE,
warning = FALSE,
cache = TRUE
)
library(tidyverse)
library(ggplot2)
library(sf)
library(mapview)
parks <- st_read("https://opendata.arcgis.com/datasets/d52445160ab14380a673e5849203eb64_0.geojson")
mapview(parks, col.regions = "green", map.types = "CartoDB.DarkMatter")
mapview(parks, col.regions = "darkgreen", map.types = "CartoDB.DarkMatter")
