---
title: "Javascript Data Exploration"
author: "Xian Lu"
date: "2024-09-10"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
library(jsonlite)
library(sf)
 setwd("C:/Users/xianl/OneDrive - PennO365/Penn Courses/Javascript/Course Materials/story-map-project/Vibes Story Map/data-main")
emotions <- st_read(
'prague-emo.gpkg'
) %>% st_transform('EPSG:5514')
library(sf)
library(tmap)
library(spatialEco)
library(raster)
library(terra)
library(dbscan)
st_crs(emotions)
tmap_mode('view')

happy <- emotions[emotions$question %in% c (1,2,15,19,20,21,40,44),]
disatisfied <- emotions[emotions$question %in% c (3,9,41,42,63),]
fear <- emotions[emotions$question %in% c (4,17,18,31,41,59),]



happy.kde <- happy %>% sf.kde(bw=1000, res=50) %>% raster()
disatisfied.kde <- disatisfied %>% sf.kde(bw=1000, res=50) %>% raster()
fear.kde <- fear %>% sf.kde(bw=1000, res=50) %>% raster()

happy.contour <- rasterToContour(happy.kde) %>% st_as_sf()
disatisfied.contour <- rasterToContour(disatisfied.kde) %>% st_as_sf()
fear.contour <- rasterToContour(fear.kde) %>% st_as_sf()

tm_shape(happy.contour %>% filter(level>0.5))+tm_lines('darkgreen', alpha=0.5)+
  tm_shape(disatisfied.contour %>% filter(level>0.5))+tm_lines('red', alpha=0.5)+
  tm_shape(fear.contour %>% filter(level>0.5))+tm_lines('purple', alpha=0.5)
  




```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
